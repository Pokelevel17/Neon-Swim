<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Retro TV â€” Dynamic Videos</title>
<style>
html,body{margin:0;padding:0;height:100%;background:#000;color:#fff;font-family:sans-serif;}
body{display:flex;align-items:center;justify-content:center;}
.player{position:relative;width:100vw;height:100vh;overflow:hidden;}
#player{width:100%;height:100%;object-fit:cover;pointer-events:none;background:#000;}
.now{position:absolute;bottom:20px;left:20px;background:rgba(0,0,0,0.6);padding:12px 16px;border-radius:8px;font-size:1.2rem;font-weight:700;}
</style>
</head>
<body>
<div class="player">
  <video id="player" autoplay muted playsinline></video>
  <div class="now" id="nowTitle">Loading...</div>
</div>

<script>
// Path to your JSON file
const JSON_URL = 'videos.json';

const player = document.getElementById('player');
const nowTitle = document.getElementById('nowTitle');

let playlist = [];
let idx = 0;

// Shuffle function
function shuffle(array){
  for(let i=array.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [array[i],array[j]]=[array[j],array[i]];
  }
  return array;
}

function loadVideo(){
  if(playlist.length===0) return;
  const video = playlist[idx];
  player.src = video.url;
  nowTitle.textContent = video.name;
  player.play();
}

function nextVideo(){
  idx = (idx + 1) % playlist.length;
  loadVideo();
}

player.addEventListener('ended', nextVideo);

// Fetch JSON and initialize
fetch(JSON_URL)
  .then(res=>res.json())
  .then(data=>{
    // Expecting data to be an array: [{ "url": "...", "name": "..." }, ...]
    playlist = shuffle(data);
    loadVideo();
  })
  .catch(err=>{
    console.error('Failed to load videos.json', err);
    nowTitle.textContent = 'Failed to load playlist';
  });
</script>
</body>
</html>
